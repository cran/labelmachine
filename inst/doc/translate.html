<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Adrian Maldet" />

<meta name="date" content="2019-10-08" />

<title>Translate variables</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Translate variables</h1>
<h4 class="author">Adrian Maldet</h4>
<h4 class="date">2019-10-08</h4>



<p>In the following, we will explain how to use a lama-dictionary (See <a href="https://a-maldet.github.io/labelmachine/articles/create_dictionaries.html">Creating lama-dictionaries</a>) in order to translate data frame variables or atomic vectors (or factor objects). The main functions are: * <code>lama_translate()</code> and <code>lama_translate_()</code>: Assign new labels to variable values and turn them into ordered factors (if <code>to_factor = TRUE</code>). * <code>lama_translate_all()</code>: Apply <code>lama_translate()</code> on all possible columns of a data frame, if there are corresponding translations. * <code>lama_to_factor()</code> and <code>lama_to_factor_()</code>: Similar to <code>lama_translate()</code> and <code>lama_translate_()</code>, but the variables already have the right values (character or factor), but should be turned into factor variables with the factor levels given in the corresponding translations. * <code>lama_to_factor_all()</code>: Apply <code>lama_to_factor()</code> on all possible columns of a data frame, if there are corresponding translations.</p>
<div id="the-example-data-frame-and-lama-dictionary" class="section level2">
<h2>The example data frame and lama-dictionary</h2>
<p>Let <code>df</code> be a data frame with the following structure:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(
  <span class="dt">pupil_id =</span> <span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">4</span>, <span class="dt">each =</span> <span class="dv">3</span>),
  <span class="dt">subject =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;eng&quot;</span>, <span class="st">&quot;mat&quot;</span>, <span class="st">&quot;gym&quot;</span>), <span class="dv">4</span>),
  <span class="dt">level =</span> <span class="kw">factor</span>(
    <span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>),
    <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>)
  ),
  <span class="dt">result =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="ot">NA</span>, <span class="dv">2</span>, <span class="ot">NA</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="ot">NA</span>),
  <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>
)
df
<span class="co">#&gt;    pupil_id subject level result</span>
<span class="co">#&gt; 1         1     eng     a      1</span>
<span class="co">#&gt; 2         1     mat     a      2</span>
<span class="co">#&gt; 3         1     gym     a      2</span>
<span class="co">#&gt; 4         2     eng     b     NA</span>
<span class="co">#&gt; 5         2     mat     b      2</span>
<span class="co">#&gt; 6         2     gym     b     NA</span>
<span class="co">#&gt; 7         3     eng     b      1</span>
<span class="co">#&gt; 8         3     mat     b      0</span>
<span class="co">#&gt; 9         3     gym     b      1</span>
<span class="co">#&gt; 10        4     eng     a      2</span>
<span class="co">#&gt; 11        4     mat     a      3</span>
<span class="co">#&gt; 12        4     gym     a     NA</span></code></pre></div>
<p>The column <code>subject</code> (<strong>character</strong>) contains the subject codes and the column <code>level</code> (<strong>factor</strong>) holds the level of the courses (<code>basic</code> and <code>advanced</code>) pupils were tested in. The column <code>result</code> (<strong>integer</strong>) contains the test results (<code>1</code> and <code>2</code> are positive, <code>3</code> and <code>4</code> are negative, <code>NA</code> means that the pupil missed the test and <code>0</code> means that something else went wrong).</p>
<p>We want to use the following lama-dictionary in order to translate the data frame variables:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(labelmachine)
dict &lt;-<span class="st"> </span><span class="kw">new_lama_dictionary</span>(
  <span class="dt">sub =</span> <span class="kw">c</span>(<span class="dt">eng =</span> <span class="st">&quot;English&quot;</span>, <span class="dt">mat =</span> <span class="st">&quot;Mathematics&quot;</span>, <span class="dt">gym =</span> <span class="st">&quot;Gymnastics&quot;</span>),
  <span class="dt">lev =</span> <span class="kw">c</span>(<span class="dt">b =</span> <span class="st">&quot;Basic&quot;</span>, <span class="dt">a =</span> <span class="st">&quot;Advanced&quot;</span>),
  <span class="dt">result =</span> <span class="kw">c</span>(
    <span class="st">&quot;1&quot;</span> =<span class="st"> &quot;Good&quot;</span>,
    <span class="st">&quot;2&quot;</span> =<span class="st"> &quot;Passed&quot;</span>,
    <span class="st">&quot;3&quot;</span> =<span class="st"> &quot;Not passed&quot;</span>,
    <span class="st">&quot;4&quot;</span> =<span class="st"> &quot;Not passed&quot;</span>,
    <span class="dt">NA_ =</span> <span class="st">&quot;Missed&quot;</span>,
    <span class="st">&quot;0&quot;</span> =<span class="st"> </span><span class="ot">NA</span>
  )
)
dict
<span class="co">#&gt; </span>
<span class="co">#&gt; --- lama_dictionary ---</span>
<span class="co">#&gt; Variable 'sub':</span>
<span class="co">#&gt;           eng           mat           gym </span>
<span class="co">#&gt;     &quot;English&quot; &quot;Mathematics&quot;  &quot;Gymnastics&quot; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Variable 'lev':</span>
<span class="co">#&gt;          b          a </span>
<span class="co">#&gt;    &quot;Basic&quot; &quot;Advanced&quot; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Variable 'result':</span>
<span class="co">#&gt;            1            2            3            4          NA_ </span>
<span class="co">#&gt;       &quot;Good&quot;     &quot;Passed&quot; &quot;Not passed&quot; &quot;Not passed&quot;     &quot;Missed&quot; </span>
<span class="co">#&gt;            0 </span>
<span class="co">#&gt;           NA</span></code></pre></div>
</div>
<div id="translate-using-non-standard-evaluation" class="section level2">
<h2>Translate using non-standard evaluation</h2>
<p>The function <code>lama_translate()</code> uses non-standard evaluation, which means that we pass in expressions, which will be parsed and we can spare the quotes surrounding column and translation names:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df_new &lt;-<span class="st"> </span><span class="kw">lama_translate</span>(
  <span class="dt">.data =</span> df,
  <span class="dt">dictionary =</span> dict,
  <span class="dt">subject_new =</span> <span class="kw">sub</span>(subject),
  <span class="dt">level =</span> <span class="kw">lev</span>(level),
  <span class="dt">result =</span> <span class="kw">result</span>(result),
  <span class="dt">keep_order =</span> <span class="kw">c</span>(<span class="ot">FALSE</span>, <span class="ot">TRUE</span>, <span class="ot">FALSE</span>),
  <span class="dt">to_factor =</span> <span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">TRUE</span>, <span class="ot">FALSE</span>)
)
<span class="kw">str</span>(df_new)
<span class="co">#&gt; 'data.frame':    12 obs. of  5 variables:</span>
<span class="co">#&gt;  $ pupil_id   : int  1 1 1 2 2 2 3 3 3 4 ...</span>
<span class="co">#&gt;  $ subject    : chr  &quot;eng&quot; &quot;mat&quot; &quot;gym&quot; &quot;eng&quot; ...</span>
<span class="co">#&gt;  $ level      : Factor w/ 2 levels &quot;Advanced&quot;,&quot;Basic&quot;: 1 1 1 2 2 2 2 2 2 1 ...</span>
<span class="co">#&gt;  $ result     : chr  &quot;Good&quot; &quot;Passed&quot; &quot;Passed&quot; &quot;Missed&quot; ...</span>
<span class="co">#&gt;  $ subject_new: Factor w/ 3 levels &quot;English&quot;,&quot;Mathematics&quot;,..: 1 2 3 1 2 3 1 2 3 1 ...</span></code></pre></div>
<p>The arguments <code>.data</code> and <code>dictionary</code> define which data frame should be translated and which lama-dictionary should be used for the translation. The argument <code>keep_order</code> defines for each given translation if the original ordering of the variable should be kept (ordering of the variable in the data frame <code>df</code>) or if the ordering given in the translation should be used. The argument <code>to_factor</code> defines for each translation, if the resulting labeled variable should be a factor variable (<code>to_factor = TRUE</code>) or a plain character variable (<code>to_factor = FALSE</code>). Besides the arguments <code>.data</code>, <code>dictionary</code> and <code>keep_order</code> all other arguments are label assignments. The names of the arguments (left hand side of the equations) define the column names under which the labeled variable should be stored. The right hand side of the assignments define the column which should be labeled (parameter name in the brackets) and which translation should be used (function name the left of the brackets). Hence, the statement above does the following things:</p>
<ul>
<li><code>subject_new = sub(subject)</code>: The column <code>subject</code> in the data frame <code>df</code> is translated using the translation <code>sub</code> and the resulting factor is stored under the column name <code>subject_new</code>. Since the first entry in <code>keep_order</code> is <code>FALSE</code>, the ordering given in the translation <code>sub</code> is used for the labels. Since the first entry in <code>to_factor</code> is <code>TRUE</code> the resulting variable is a factor variable.</li>
<li><code>level = lev(level)</code>: The column <code>level</code> in the data frame <code>df</code> is translated using the translation <code>lev</code> and then overwritten by the resulting factor. Since the second entry in <code>keep_order</code> is <code>TRUE</code>, the labeled variable has the same ordering as the original column. Since the second entry in <code>to_factor</code> is <code>TRUE</code> the resulting variable is a factor variable.</li>
<li><code>result = result(result)</code>: The column <code>result</code> in the data frame <code>df</code> is translated using the translation <code>result</code> and then overwritten by the resulting factor. Since the third entry in <code>keep_order</code> is <code>FALSE</code>, the ordering given in the translation is used for the labels. Since the third entry in <code>to_factor</code> is <code>FALSE</code> the resulting variable is a plain character variable.</li>
</ul>
<p>There are several abbreviations, in order to spare some writing:</p>
<ul>
<li>If the translation has the same name as the original column name, then it is sufficient to just write the translation name on the right hand side. E.g: <code>result_new = result</code> is the same as <code>result_new = result(result)</code>.</li>
<li>If the column name under which the labeled variable should be stored is the same as the original column name, then the left hand side of the assignment can be omitted. E.g: <code>lev(level)</code> is the same as <code>level = lev(level)</code>.</li>
<li>If the names of the translation, of the original column and the new column are equal then only the name of the translation is needed. E.g: <code>result</code> is the same as <code>result = result(result)</code>.</li>
</ul>
</div>
<div id="translate-using-standard-evaluation" class="section level2">
<h2>Translate using standard evaluation</h2>
<p>The function <code>lama_translate_()</code> is the standard evaluation variant of <code>lama_translate()</code>, which means that instead of expressions, we pass in character strings holding the names of the translations and columns we want to use:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df_new &lt;-<span class="st"> </span><span class="kw">lama_translate_</span>(
  <span class="dt">.data =</span> df,
  <span class="dt">dictionary =</span> dict,
  <span class="dt">translation =</span> <span class="kw">c</span>(<span class="st">&quot;sub&quot;</span>, <span class="st">&quot;lev&quot;</span>, <span class="st">&quot;result&quot;</span>),
  <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;subject&quot;</span>, <span class="st">&quot;level&quot;</span>, <span class="st">&quot;result&quot;</span>),
  <span class="dt">col_new =</span> <span class="kw">c</span>(<span class="st">&quot;subject_new&quot;</span>, <span class="st">&quot;level&quot;</span>, <span class="st">&quot;result&quot;</span>),
  <span class="dt">keep_order =</span> <span class="kw">c</span>(<span class="ot">FALSE</span>, <span class="ot">TRUE</span>, <span class="ot">FALSE</span>),
  <span class="dt">to_factor =</span> <span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">TRUE</span>, <span class="ot">FALSE</span>)
)
<span class="kw">str</span>(df_new)
<span class="co">#&gt; 'data.frame':    12 obs. of  5 variables:</span>
<span class="co">#&gt;  $ pupil_id   : int  1 1 1 2 2 2 3 3 3 4 ...</span>
<span class="co">#&gt;  $ subject    : chr  &quot;eng&quot; &quot;mat&quot; &quot;gym&quot; &quot;eng&quot; ...</span>
<span class="co">#&gt;  $ level      : Factor w/ 2 levels &quot;Advanced&quot;,&quot;Basic&quot;: 1 1 1 2 2 2 2 2 2 1 ...</span>
<span class="co">#&gt;  $ result     : chr  &quot;Good&quot; &quot;Passed&quot; &quot;Passed&quot; &quot;Missed&quot; ...</span>
<span class="co">#&gt;  $ subject_new: Factor w/ 3 levels &quot;English&quot;,&quot;Mathematics&quot;,..: 1 2 3 1 2 3 1 2 3 1 ...</span></code></pre></div>
<p>The arguments <code>.data</code> and <code>dictionary</code> define which data frame should be translated and which lama-dictionary should be used for the translation. The argument <code>keep_order</code> defines for each given translation if the original ordering of the variable should be kept (ordering of the variable in the data frame <code>df</code>) or if the ordering given in the translation should be used. The result is the same as before, when we used <code>lama_translate()</code>.</p>
</div>
<div id="translate-all-possible-variables" class="section level2">
<h2>Translate all possible variables</h2>
<p>The function <code>lama_translate_all()</code> is an extension of <code>lama_translate()</code>, which tries to automatically translate as many columns in the data frame <code>.data</code> as possible. Therefore, the names of the columns which should be translated must match the names of the translations which should be used:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df_new &lt;-<span class="st"> </span><span class="kw">lama_translate_all</span>(
  <span class="dt">.data =</span> df,
  <span class="dt">dictionary =</span> dict,
  <span class="dt">prefix =</span> <span class="st">&quot;new_&quot;</span>,
  <span class="dt">fn_colname =</span> toupper,
  <span class="dt">suffix =</span> <span class="st">&quot;_labeled&quot;</span>,
  <span class="dt">keep_order =</span> <span class="ot">TRUE</span>
)
<span class="kw">str</span>(df_new)
<span class="co">#&gt; 'data.frame':    12 obs. of  5 variables:</span>
<span class="co">#&gt;  $ pupil_id          : int  1 1 1 2 2 2 3 3 3 4 ...</span>
<span class="co">#&gt;  $ subject           : chr  &quot;eng&quot; &quot;mat&quot; &quot;gym&quot; &quot;eng&quot; ...</span>
<span class="co">#&gt;  $ level             : Factor w/ 2 levels &quot;a&quot;,&quot;b&quot;: 1 1 1 2 2 2 2 2 2 1 ...</span>
<span class="co">#&gt;  $ result            : num  1 2 2 NA 2 NA 1 0 1 2 ...</span>
<span class="co">#&gt;  $ new_RESULT_labeled: Factor w/ 4 levels &quot;Good&quot;,&quot;Passed&quot;,..: 1 2 2 4 2 4 1 NA 1 2 ...</span></code></pre></div>
<p>In the above example, only the column name <code>result</code> matches the translation name and is therefore translated and stored under the column name <code>new_RESULT_labeled</code>. The name of the new columns is a transformation of the old column name (e.g. <code>result</code>), appending the strings given in the arguments <code>prefix</code> and <code>suffix</code> at the beginning and at the end of the column name. Before this string concatenation, the name of the original column can be transformed into a other string by using the string transformation function <code>fn_colname</code>. In our case <code>fn_colname</code> is given the function <code>toupper</code> which transforms all letters of the column name <code>result</code> to upper case <code>RESULT</code>. Contrary to <code>lama_translate()</code>, the argument <code>keep_order</code> is just a single boolean flag. It defines whether the original order of all columns should be kept (<code>keep_order = TRUE</code>) or if the order in the translation vector should be used. Like in the case of <code>lama_translate()</code>, it is possible to pass an argument <code>to_factor = FALSE</code> <code>lama_translate_all</code> in order to define that all resulting labeled variables shall be stored as plain character vectors.</p>
</div>
<div id="translate-vectors" class="section level2">
<h2>Translate vectors</h2>
<p>So far, we only translated variables in data frames, but it is also possible to use <code>lama_translate()</code> and <code>lama_translate_()</code> in order to translate atomic vectors (character, logical, numeric) and factors.</p>
<p>Using <code>lama_translate()</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vec &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;eng&quot;</span>, <span class="st">&quot;eng&quot;</span>, <span class="st">&quot;gym&quot;</span>, <span class="st">&quot;mat&quot;</span>)
vec_labeled &lt;-<span class="st"> </span><span class="kw">lama_translate</span>(vec, dict, sub)</code></pre></div>
<p>Using <code>lama_translate_()</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vec_labeled &lt;-<span class="st"> </span><span class="kw">lama_translate_</span>(vec, dict, <span class="st">&quot;sub&quot;</span>)</code></pre></div>
</div>
<div id="turn-labeled-variables-into-factors" class="section level2">
<h2>Turn labeled variables into factors</h2>
<p>Sometimes, you already have labeled variables (character or factor variables, maybe produced by <code>lama_translate()</code> with argument <code>to_factor = FALSE</code>) and you want to turn them into factor variables with a desired ordering. In this case the functions <code>lama_to_factor()</code>, <code>lama_to_factor_()</code> <code>lama_to_factor_all()</code> are right choices.</p>
<p>Let <code>df_non_factor</code> a data frame holding the right labels, but no factor variables (created with <code>lama_translate_all()</code> using <code>to_factor = FALSE</code>):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dict_new &lt;-<span class="st"> </span><span class="kw">lama_rename</span>(dict, <span class="dt">subject =</span> sub, <span class="dt">level =</span> lev)
df_non_factor &lt;-<span class="st"> </span><span class="kw">lama_translate_all</span>(df, dict_new, <span class="dt">to_factor =</span> <span class="ot">FALSE</span>)
<span class="kw">str</span>(df_non_factor)
<span class="co">#&gt; 'data.frame':    12 obs. of  4 variables:</span>
<span class="co">#&gt;  $ pupil_id: int  1 1 1 2 2 2 3 3 3 4 ...</span>
<span class="co">#&gt;  $ subject : chr  &quot;English&quot; &quot;Mathematics&quot; &quot;Gymnastics&quot; &quot;English&quot; ...</span>
<span class="co">#&gt;  $ level   : chr  &quot;Advanced&quot; &quot;Advanced&quot; &quot;Advanced&quot; &quot;Basic&quot; ...</span>
<span class="co">#&gt;  $ result  : chr  &quot;Good&quot; &quot;Passed&quot; &quot;Passed&quot; &quot;Missed&quot; ...</span></code></pre></div>
<p>Turning variables into factors with <code>lama_to_factor()</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df_factor &lt;-<span class="st"> </span><span class="kw">lama_to_factor</span>(
  <span class="dt">.data =</span> df_non_factor,
  <span class="dt">dictionary =</span> dict,
  <span class="dt">subject_new =</span> <span class="kw">sub</span>(subject),
  <span class="dt">level =</span> <span class="kw">lev</span>(level),
  <span class="dt">result =</span> <span class="kw">result</span>(result)
)
<span class="kw">str</span>(df_factor)
<span class="co">#&gt; 'data.frame':    12 obs. of  5 variables:</span>
<span class="co">#&gt;  $ pupil_id   : int  1 1 1 2 2 2 3 3 3 4 ...</span>
<span class="co">#&gt;  $ subject    : chr  &quot;English&quot; &quot;Mathematics&quot; &quot;Gymnastics&quot; &quot;English&quot; ...</span>
<span class="co">#&gt;  $ level      : Factor w/ 2 levels &quot;Basic&quot;,&quot;Advanced&quot;: 2 2 2 1 1 1 1 1 1 2 ...</span>
<span class="co">#&gt;  $ result     : Factor w/ 4 levels &quot;Good&quot;,&quot;Passed&quot;,..: 1 2 2 4 2 4 1 NA 1 2 ...</span>
<span class="co">#&gt;  $ subject_new: Factor w/ 3 levels &quot;English&quot;,&quot;Mathematics&quot;,..: 1 2 3 1 2 3 1 2 3 1 ...</span></code></pre></div>
<p>The function <code>lama_to_factor()</code> allows the same abbreviations as <code>lama_translate()</code>. It can also be used on factor variables and there is also a <code>keep_order</code> argument like in the case of <code>lama_translate()</code>. Furthermore, the functions <code>lama_to_factor()</code> and <code>lama_to_factor_()</code> can both be applied to atomic vectors or plain factors like in the case of <code>lama_translate()</code>.</p>
<p>Turning variables in a data frame into factors with <code>lama_to_factor_()</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df_factor &lt;-<span class="st"> </span><span class="kw">lama_to_factor_</span>(
  <span class="dt">.data =</span> df_non_factor,
  <span class="dt">dictionary =</span> dict,
  <span class="dt">translation =</span> <span class="kw">c</span>(<span class="st">&quot;sub&quot;</span>, <span class="st">&quot;lev&quot;</span>, <span class="st">&quot;result&quot;</span>),
  <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;subject&quot;</span>, <span class="st">&quot;level&quot;</span>, <span class="st">&quot;result&quot;</span>)
)
<span class="kw">str</span>(df_factor)
<span class="co">#&gt; 'data.frame':    12 obs. of  4 variables:</span>
<span class="co">#&gt;  $ pupil_id: int  1 1 1 2 2 2 3 3 3 4 ...</span>
<span class="co">#&gt;  $ subject : Factor w/ 3 levels &quot;English&quot;,&quot;Mathematics&quot;,..: 1 2 3 1 2 3 1 2 3 1 ...</span>
<span class="co">#&gt;  $ level   : Factor w/ 2 levels &quot;Basic&quot;,&quot;Advanced&quot;: 2 2 2 1 1 1 1 1 1 2 ...</span>
<span class="co">#&gt;  $ result  : Factor w/ 4 levels &quot;Good&quot;,&quot;Passed&quot;,..: 1 2 2 4 2 4 1 NA 1 2 ...</span></code></pre></div>
<p>Since the argument <code>col_new</code> was omitted, the variable names (<code>subject</code>, <code>level</code> and <code>result</code>) were overwritten.</p>
<p>Turning all possible variables in a data frame into factors with <code>lama_to_factor_all()</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df_factor &lt;-<span class="st"> </span><span class="kw">lama_to_factor_all</span>(
  <span class="dt">.data =</span> df_non_factor,
  <span class="dt">dictionary =</span> dict
)
<span class="kw">str</span>(df_factor)
<span class="co">#&gt; 'data.frame':    12 obs. of  4 variables:</span>
<span class="co">#&gt;  $ pupil_id: int  1 1 1 2 2 2 3 3 3 4 ...</span>
<span class="co">#&gt;  $ subject : chr  &quot;English&quot; &quot;Mathematics&quot; &quot;Gymnastics&quot; &quot;English&quot; ...</span>
<span class="co">#&gt;  $ level   : chr  &quot;Advanced&quot; &quot;Advanced&quot; &quot;Advanced&quot; &quot;Basic&quot; ...</span>
<span class="co">#&gt;  $ result  : Factor w/ 4 levels &quot;Good&quot;,&quot;Passed&quot;,..: 1 2 2 4 2 4 1 NA 1 2 ...</span></code></pre></div>
<p>Since the arguments <code>prefix</code>, <code>suffix</code> and <code>fn_colname</code> were omitted, the variable names (<code>subject</code>, <code>level</code> and <code>result</code>) were overwritten.</p>
</div>
<div id="further-reading" class="section level2">
<h2>Further reading</h2>
<ul>
<li><a href="https://a-maldet.github.io/labelmachine/articles/create_dictionaries.html">Creating lama-dictionaries</a></li>
<li><a href="https://a-maldet.github.io/labelmachine/articles/alter_dictionaries.html">Altering lama-dictionaries</a></li>
<li><a href="https://a-maldet.github.io/labelmachine/articles/labelmachine.html">Get started</a></li>
</ul>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
